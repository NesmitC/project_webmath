<!-- templates/admin/view_test.html -->
{% extends "base.html" %}

{% block title %}Просмотр теста | Админка{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">{{ test_type.name | title }} диагностика</h1>

<!-- Кнопка редактирования текста теста -->
<a href="{{ url_for('admin.edit_test', test_type_name=test_type.name) }}"
    class="inline-block mb-6 bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded text-sm">
    ✏️ Редактировать текст теста
</a>

<!-- Текст задания -->
<div class="bg-white p-4 rounded border mb-6">
    <h2 class="font-semibold mb-2">Текст задания</h2>
    <p class="text-sm leading-relaxed whitespace-pre-wrap">{{ test.test_text }}</p>
</div>

<!-- Список вопросов с кнопками редактирования -->
<h2 class="text-xl font-semibold mb-4">Вопросы</h2>
<div class="space-y-4">
    {% for q in test.questions %}
    <div class="bg-gray-50 p-4 rounded flex justify-between items-start gap-4">
        <div class="flex-1">
            <p class="font-medium">
                <strong>{{ q.question_number }}.</strong> {{ q.question_text }}
            </p>
            <p class="text-sm text-gray-600 mt-1">
                <strong>Тип:</strong> {{ q.question_type }} |
                <strong>Ответ:</strong> {{ q.correct_answer }}
            </p>
            {% if q.options %}
            <p class="text-xs text-gray-500 mt-1">
                <strong>Варианты:</strong> {{ q.options }}
            </p>
            {% endif %}
            {% if q.info %}
            <p class="text-xs text-gray-500 mt-1">
                <strong>Инфо:</strong> {{ q.info }}
            </p>
            {% endif %}
        </div>
        <div class="flex-shrink-0 space-y-2">
            <!-- Кнопка редактирования вопроса -->
            <a href="{{ url_for('admin.edit_question', question_id=q.id) }}"
                class="block text-yellow-600 hover:text-yellow-800 hover:underline text-sm font-medium">
                ✏️ Редактировать
            </a>

        </div>
    </div>
    {% else %}
    <p class="text-gray-500">Нет вопросов.</p>
    {% endfor %}
</div>

<!-- Кнопка добавления вопроса -->
<div class="mt-6">
    <a href="{{ url_for('admin.add_question', test_type_name=test_type.name) }}"
        class="inline-block bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm font-medium transition">
        ➕ Добавить вопрос
    </a>
</div>
{% endblock %}